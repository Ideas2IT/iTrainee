@model iTrainee.Models.UserAudit;
@{
    ViewData["Title"] = "Trainee";
}

<head>
    <style>
        .calendar {
            position: relative;
            width: 160px;
        }

            .calendar .calendar-body {
                display: flex;
                margin-top: 3px;
                align-items: center;
                flex-direction: column;
                width: 60%;
                border-bottom: 6px solid #0366d6;
                border-right: 3px solid #0366d6;
                border-left: 3px solid #0366d6;
                border-radius: 8px;
                background: #fff;
            }

            .calendar .calendar-body {
                display: flex;
                align-items: center;
                flex-direction: column;
                width: 40%;
                border-bottom: 2px solid #0366d6;
                border-right: 2px solid #0366d6;
                border-left: 2px solid #0366d6;
                border-radius: 8px;
                background: #fff;
                margin-left: 5em;
            }

                .calendar .calendar-body .month-name {
                    color: #fff;
                    background: #0366d6;
                    width: 100%;
                    font-size: 1.0em;
                    text-align: center;
                    font-weight: 400;
                    border-top-left-radius: 6px;
                    border-top-right-radius: 6px;
                }

                .calendar .calendar-body .month-name {
                    color: #fff;
                    background: #0366d6;
                    width: 100%;
                    font-size: 0.8em;
                    text-align: center;
                    border-top-left-radius: 6px;
                    border-top-right-radius: 6px;
                }

                .calendar .calendar-body .day-name {
                    color: #051320;
                    font-size: 0.9em;
                    font-weight: 400;
                    margin-top: 5px;
                }

                .calendar .calendar-body .day-name {
                    color: #051320;
                    font-size: 0.7em;
                    margin-top: 3px;
                }

                .calendar .calendar-body .date-number {
                    color: #051320;
                    font-size: 1.3em;
                    font-weight: 600;
                    line-height: 1.0em;
                }

                .calendar .calendar-body .year {
                    color: #051320;
                    font-size: 0.9em;
                    font-weight: 400;
                    margin-bottom: 2px;
                }

                .calendar .calendar-body .year {
                    color: #051320;
                    font-size: 0.7em;
                    margin-bottom: 2px;
                }

        .time {
            font-size: 1.1em;
            border-bottom: 6px solid #0366d6;
            border-top: 6px solid #0366d6;
            border-right: 3px solid #0366d6;
            border-left: 3px solid #0366d6;
            border-radius: 8px;
            margin-top: 8px;
            padding: 5px;
            font-size: 0.9em;
            border-bottom: 3px solid #0366d6;
            border-top: 3px solid #0366d6;
            border-right: 1px solid #0366d6;
            border-left: 1px solid #0366d6;
            border-radius: 5px;
            padding: 3px;
            margin-left: 50em;
        }

        .time1 {
            font-size: 0.9em;
            border-bottom: 3px solid #0366d6;
            border-top: 3px solid #0366d6;
            border-right: 1px solid #0366d6;
            border-left: 1px solid #0366d6;
            border-radius: 5px;
            padding: 3px;
            margin-left: 2em;
        }

        .dates {
            font-size: 0.9em;
            border-bottom: 3px solid #0366d6;
            border-top: 3px solid #0366d6;
            border-right: 1px solid #0366d6;
            border-left: 1px solid #0366d6;
            border-radius: 5px;
            padding: 3px;
        }

        .date {
            font-size: 1.1em;
            border-bottom: 6px solid #0366d6;
            border-top: 6px solid #0366d6;
            border-right: 3px solid #0366d6;
            border-left: 3px solid #0366d6;
            border-radius: 8px;
            padding: 5px;
            margin-top: 20px;
            margin-right: 44em;
            font-size: 0.9em;
            border-bottom: 6px solid #0366d6;
            border-top: 6px solid #0366d6;
            border-right: 3px solid #0366d6;
            border-left: 3px solid #0366d6;
            border-radius: 8px;
            padding: 5px;
            margin-right: 44em;
        }

        .range-width {
            width: 460px;
        }

        #slider-cntnr {
            position: relative;
        }

        #frame-slider {
            width: 100%;
            margin: 0;
        }

        #slider-follow {
            margin-left: -14px;
            width: 30px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
        }

        #slider-val-cntnr {
            background-color: white;
            width: 25px;
            height: 20px;
        }

        .topic-name:hover {
            font-size: 1.1rem;
            transition: transform .2s;
            cursor: pointer;
            padding: 15px 5px;
            background-color: #F1F3F4;
            border-radius: 5px;
        }

        .topic-name {
            padding: 15px 5px;
        }

        .topic-subtopic {
            display: flex;
        }

        .topic-list {
            flex: 2;
        }

        .subtopic-list {
            flex: 4;
        }
        .btn-status, .btn-status:hover {
            background: linear-gradient(144deg,#009ffd, rgb(0,35,155) 50%);
            color: white;
        }
    </style>
</head>

<div class="row">
    @if (Convert.ToString(TempData["FirstName"]) == "TraineeName")
    {
        <h2 class="font-weight-bold mt-4 mb-5">Hello @TempData["UserFirstName"],</h2>
    }

    @if (Convert.ToString(TempData["FirstName"]) == "MentorName")
    {
        <div class="">
            <p class="dates">Date : @Model.Date.ToShortDateString()</p>
        </div>
        <div class="">
            <p class="time">Sign-In : @Model.SignIn.ToShortTimeString()</p>
        </div>
        <div class="">
            <p class="time1">Sign-Out : @Model.SignOut.ToShortTimeString()</p>
        </div>
    }
    else
    {
        @*<div class="col">
            <div class="calendar float-right">
            <div class="calendar-body">
            <span class="month-name">Month</span>
            <span class="day-name">Day</span>
            <span class="date-number">00</span>
            </div>
            </div>
            </div>*@
        @* <div class="">
            <p class="time">Sign-In : @Model.SignIn.ToShortTimeString()</p>
            </div>
            <div class="">
            <p class="time">Sign-Out : @Model.SignOut.ToShortTimeString()</p>
            </div> *@
    }
</div>

<div class="topic-subtopic">
    <div class="topic-list nav flex-column">
        @foreach (var topic in Model.AssignedTopicsList)
        {
            <div class="topic-name nav-item">@topic.Name</div>
            @*
                @foreach (var subTopic in Model.AssignedSubTopicsList)
                {
                @if (topic.Id == subTopic.TopicId)
                {
                <p>@subTopic.Name</p>
                <button data-toggle="modal" class="btn btn-add-gradient btn-primary mb-3" onclick="GetDailyProgress(@subTopic.Id, @Model.UserId)" data-target="#myModal2">Add status</button>
                <br />
                <div class="progress" style="width: 100%">
                <div class="progress-bar" style="width: @subTopic.Percentage%; background-color:blue" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">@subTopic.Percentage %</div>
                </div>
                }
                }*@
        }
    </div>


    <div class="subtopic-list">
        @foreach (var topic in Model.AssignedTopicsList)
        {
            @foreach (var subTopic in Model.AssignedSubTopicsList)
            {
                @if (1 == subTopic.TopicId)
                {
                    <div class="row mt-3">
                        <div class="col-8">

                            <div class="d-inline">@subTopic.Name</div>
                            <br />
                            <div class="progress">
                                <div class="progress-bar" style="width: @subTopic.Percentage%; background-color:blue" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">@subTopic.Percentage %</div>
                            </div>
                        </div>
                        <div class="col-3">
                            <button data-toggle="modal" class="btn btn-sm mt-2 btn-status" onclick="GetDailyProgress(@subTopic.Id, @Model.UserId)" data-target="#myModal2">Add status</button>
                        </div>
                    </div>
                }
            }
        }
    </div>
</div>

<div class="modal" fade" id="myModal2">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Status</h3>
            </div>
            <div class="modal-body" id="myModalBodyDiv1">

                <form id="myForm" method="Post">
                    @Html.AntiForgeryToken()
                    <div class="row">
                        <div class="col-lg-12">

                            <div class="form-group">
                                <label class="col-form-label">Start Date</label>
                                <input type="date" class="form-control" name="startDate" required />
                            </div>

                            <div class="form-group">
                                <label class="col-form-label">End Date</label>
                                <input type="date" class="form-control" name="endDate" required />
                            </div>
                            <div id="slider-cntnr">
                                <label for="customRange1" class="form-label">Percentage</label>
                                <input type="range" id="frame-slider" class="range-width" oninput="updateFollowerValue(this.value)" />
                                <div id="slider-follow">
                                    <div id="slider-val-cntnr">
                                        <span id="slider-val"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group padding-top-15px mt-3">
                                <label class="col-form-label">Trainee Comments</label>
                                <textarea class="form-control" name="comments"></textarea>
                            </div>

                            <div class="form-group padding-top-15px mt-3">
                                <label class="col-form-label">Mentor Comments</label>
                                <textarea class="form-control" name="comments" disabled></textarea>
                            </div>

                            <div class="form-group mt-4 float-right">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <input type="submit" value="Save" name="submit" id="btnSubmit" class="btn btn-primary mr-3" />
                            </div>
                        </div>

                    </div>

                </form>


            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    const dayNumber = new Date().getDate();
    const year = new Date().getFullYear();
    const dayName = new Date().toLocaleString("default", { weekday: "long" });
    const monthName = new Date().toLocaleString("default", { month: "long" });

    document.querySelector(".month-name").innerHTML = monthName;
    document.querySelector(".day-name").innerHTML = dayName;
    document.querySelector(".date-number").innerHTML = dayNumber;
    document.querySelector(".year").innerHTML = year;

    var follower = document.getElementById('slider-follow');
    var follower_val = document.getElementById('slider-val');
    var slider = document.getElementById('frame-slider');

    var updateFollowerValue = function(val) {
    follower_val.innerHTML = val;
    follower.style.left = val + '%';
    };

    updateFollowerValue(slider.value);


    var GetDailyProgress = function (SubTopicId, UserId) {
    var UserPath = "/Trainee/Home/GetDailyProgress?userId=" + UserId + "&subTopicId=" + SubTopicId;
    $("#myModalBodyDiv1").load(UserPath, function () {
    $("#myModal2").modal("show");
    });
    };
</script>


